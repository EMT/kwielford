<?php

namespace app\models;

class Faces extends \lithium\data\Model {

    protected $_meta = [
        'connection' => 'mongodb'
    ];

    // protected $_schema = array(
    //     '_id'  => array('type' => 'id'),
    //     'face' => array('type' => 'string', 'null' => false)
    // );

    public static $_faces = [
        [
            '00000000000000000000000000000000',
            '00000000000000000000000000000000',
            '00000111000000000000000011100000',
            '00001000100000000000000100010000',
            '00000000000000000000000000000000',
            '00000000000000000000000000000000',
            '00000000000000000000000000000000',
            '00000000000000000000000000000000'
        ],
        [
            '00000000000000000000000000000000',
            '00000000000000000000000000000000',
            '00000000000000000000000000000000',
            '00000000000000000000000000000000',
            '00001000100000000000000100010000',
            '00000111000000000000000011100000',
            '00000000000000000000000000000000',
            '00000000000000000000000000000000'
        ],
        [
            '00000000000000000000000000000000',
            '00000000000000000000000000000000',
            '00000111100000000000000111100000',
            '00001011100000000000000111010000',
            '00000000000000000000000000000000',
            '00000000000000000000000000000000',
            '00000000000000000000000000000000',
            '00000000000000000000000000000000'
        ]
    ];

	public static function faceForMood($mood) {
        $face = Faces::create();
        $face->face = static::$_faces[rand(0, count(static::$_faces) - 1)];
        return $face;
    }

    public function forArduino($entity) {
        if ($entity->face) {
            $arduino_face = [[], [], [], []];
            foreach ($entity->face as $key => $row) {
                for ($i = 0; $i < 4; $i ++) {
                    $arduino_face[$i][$key] = bindec(substr($row, $i * 8, 8));
                }
            }
            return $arduino_face;
        }
    }
}

?>